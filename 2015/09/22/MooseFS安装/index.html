<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> MooseFS安装 · Tianchi's Blog</title><meta name="description" content="MooseFS安装 - Tian chi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/long.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://itanch.github.io/atom.xml" title="Tianchi's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/long.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/ITanCh" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">MooseFS安装</h1><div class="post-info">Sep 22, 2015</div><div class="post-content"><blockquote>
<p>MooseFS is a Fault tolerant, Highly available, Highly performing, Scaling-out, Network distributed file system. It spreads data over several physical commodity servers, which are visible to the user as one resource. For standard file operations MooseFS acts like any other Unix-like file system:<br>        1.A hierarchical structure (directory tree)<br>    2.Stores POSIX file attributes (permissions, last access and modification times)<br>    3.Supports special files (block and character devices, pipes and sockets)<br>    4.Symbolic links (file names pointing to target files, not necessarily on MooseFS) and hard links (different names of files which refer to the same data on MooseFS)<br>    5.Access to the file system can be limited based on IP address and/or password</p>
</blockquote>
<h3 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h3><p>实验环境：两个Ubuntu14.04计算机。<br>MooseFS版本：2.0.76。  </p>
<p>MooseFS<a href="http://www.moosefs.org/" target="_blank" rel="external">官网1</a>，<a href="http://moosefs.com/index.html" target="_blank" rel="external">官网2</a>。据观察，官网2内容较新。</p>
<p><a href="http://moosefs.com/download/ubuntudebian.html" target="_blank" rel="external">参考1</a>，<a href="http://moosefs.com/Content/Downloads/MooseFS-2-0-60-User-Manual.pdf" target="_blank" rel="external">参考2</a>。<br><a id="more"></a></p>
<h3 id="安装master-在选定的master节点上操作"><a href="#安装master-在选定的master节点上操作" class="headerlink" title="安装master(在选定的master节点上操作)"></a>安装master(在选定的master节点上操作)</h3><p>添加key:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ wget -O - http://ppa.moosefs.com/moosefs.key | sudo apt-key add -</div></pre></td></tr></table></figure>  </p>
<p>在文件<code>/etc/apt/sources.list.d/moosefs.list</code>中添加如下软件源：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">deb http://ppa.moosefs.com/stable/apt/ubuntu/trusty trusty main</div></pre></td></tr></table></figure></p>
<p>更新软件源，安装master：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get install moosefs-master</div></pre></td></tr></table></figure></p>
<p>拷贝<code>/etc/mfs</code>下的如下文件，可以按需修改其中的参数，也可以使用默认值：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cp mfsmaster.cfg.dist mfsmaster.cfg</div><div class="line">$ cp mfsexports.cfg.dist mfsexports.cfg</div></pre></td></tr></table></figure></p>
<p>启动：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo mfsmaster start</div></pre></td></tr></table></figure><br>可以修改<code>/etc/default/moosefs-ce-master</code>中的<code>MFSMASTER_ENABLE</code>为<code>true</code>，使得该服务开机启动。</p>
<h3 id="安装其它工具"><a href="#安装其它工具" class="headerlink" title="安装其它工具"></a>安装其它工具</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install moosefs-cgi</div><div class="line">$ sudo apt-get install moosefs-cgiserv</div><div class="line">$ sudo apt-get install moosefs-cli</div></pre></td></tr></table></figure>  
<p>启动mfscgiserv，可以在浏览器观察mfs运行情况。如果本机为master，可以访问<a href="http://127.0.0.1:9425" target="_blank" rel="external">http://127.0.0.1:9425</a>。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo mfscgiserv start</div></pre></td></tr></table></figure></p>
<h3 id="安装chunkserver-在选定的chunk节点上操作"><a href="#安装chunkserver-在选定的chunk节点上操作" class="headerlink" title="安装chunkserver(在选定的chunk节点上操作)"></a>安装chunkserver(在选定的chunk节点上操作)</h3><p>首先像安装master一样添加软件源，然后安装：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install moosefs-chunkserver</div></pre></td></tr></table></figure>  </p>
<p>同样，修改<code>/etc/mfs</code>文件下的如下文件：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ sudo cp mfschunkserver.cfg.dist mfschunkserver.cfg</div><div class="line">$ sudo cp mfshdd.cfg.dist mfshdd.cfg</div></pre></td></tr></table></figure><br>其中，<code>mfschunkserver.cfg</code>文件的参数<code>MASTER_HOST = mfsmaster</code>可以指定master的hostname，这里需要在<code>/etc/hosts</code>中写明，并且如果master也作为chunkserver时，hosts中mfsmaster的ip不能使用127.0.0.1。</p>
<p>建立文件,文件名字可以写自己喜欢的，这里取名mfschunk：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mkdir -p /mnt/mfschunk</div><div class="line">$ chown -R mfs:mfs /mnt/mfschunk</div></pre></td></tr></table></figure></p>
<p>在<code>mfshdd.cfg</code>文件中添加一行<code>/mnt/mfschunk</code>。启动mfschunkserver:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo mfschunkserver start</div></pre></td></tr></table></figure></p>
<h3 id="安装客户端"><a href="#安装客户端" class="headerlink" title="安装客户端"></a>安装客户端</h3><p>安装客户端，添加挂载点，进行挂载。mfsmaster在这里为master的hostname。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install moosefs-client</div><div class="line">$ sudo mkdir -p /mnt/mfs</div><div class="line">$ sudo mfsmount mfs -H mfsmaster</div></pre></td></tr></table></figure></p>
<p>查看：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ df -h</div><div class="line">mfsmaster:9421  1.3T   70G  1.2T    6% /mnt/mfs</div></pre></td></tr></table></figure></p>
</div></article></div></main><footer><div class="paginator"><a href="/2015/11/16/MESOS安装/" class="prev">上一篇</a><a href="/2015/09/10/slurm安装/" class="next">下一篇</a></div><div data-thread-key="2015/09/22/MooseFS安装/" data-title="MooseFS安装" data-url="http://itanch.github.io/2015/09/22/MooseFS安装/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"tianchi"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2016 - 2017 <a href="http://itanch.github.io">Tian chi</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>